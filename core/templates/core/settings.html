{% extends "base.html" %}

{% block title %}
<title>Настройки</title>
{% endblock %}

{% block content %}
<h2 class="settings-title">Настройки: {{request.user.userprofile.name}}</h2>

    <form enctype="multipart/form-data" method="post">
        {% csrf_token %}

        <div class="form-group">
            <label for="login" class="form-label">Логин</label>
            <input type="text" id="login" class="form-input" value="{{ request.user.username }}">
            <!-- <div class="form-error">Введите корректный email-адерс</div> -->
        </div>

        <div class="form-group">
            <label for="name" class="form-label">Имя</label>
            <input type="text" id="name" class="form-input" value="{{ request.user.userprofile.name }}">
            <!-- <div class="form-error">Минимальная длинна пароля - 3 символа (английские буквы, цифры, нижнее подчёркивание)</div> -->
        </div>

        <div class="form-group">
            <label class="form-label">Аватар</label>
            <div class="avatar-upload">
                <div class="avatar-preview">
                    <img id="avatar-preview" src="{{ request.user.userprofile.avatar.url }}" alt="Текущий аватар" class="avatar-current">
                </div>
                <input type="file" id="avatar" class="avatar-input" accept="image/*" name="avatar">
                <label for="avatar" class="avatar-btn">Выбрать изображение</label>
            </div>
        </div>

        <script>
        const avatarInput = document.getElementById('avatar');
        const avatarPreview = document.getElementById('avatar-preview');

        avatarInput.addEventListener('change', function(){
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    avatarPreview.src = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        });
        </script>

        <button type="submit" class="save-btn">Сохранить</button>
    </form>
{% endblock %}
